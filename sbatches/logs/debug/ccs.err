Found cached dataset imdb (/mnt/xfs/home/branhung/.cache/huggingface/datasets/imdb/plain_text/1.0.0/d613c88cf8fa3bab83b4ded3713f1f74830d1100e171db75bbddb80b3345c9c0)
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 333.38it/s]
Using pad_token, but it is not set yet.
Token indices sequence length is longer than the specified maximum sequence length for this model (517 > 512). Running this sequence through the model will result in indexing errors
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:16,  1.81s/it] 20%|██        | 2/10 [00:02<00:10,  1.26s/it] 30%|███       | 3/10 [00:03<00:07,  1.09s/it] 40%|████      | 4/10 [00:04<00:06,  1.01s/it] 50%|█████     | 5/10 [00:05<00:04,  1.04it/s] 60%|██████    | 6/10 [00:06<00:03,  1.07it/s] 70%|███████   | 7/10 [00:07<00:02,  1.09it/s] 80%|████████  | 8/10 [00:08<00:01,  1.10it/s] 90%|█████████ | 9/10 [00:08<00:00,  1.11it/s]100%|██████████| 10/10 [00:09<00:00,  1.12it/s]100%|██████████| 10/10 [00:09<00:00,  1.02it/s]
Found cached dataset amazon_polarity (/mnt/xfs/home/branhung/.cache/huggingface/datasets/amazon_polarity/amazon_polarity/3.0.0/a27b32b7e7b88eb274a8fa8ba0f654f1fe998a87c22547557317793b5d2772dc)
  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 29.49it/s]
Using pad_token, but it is not set yet.
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:11,  1.27s/it] 20%|██        | 2/10 [00:02<00:08,  1.05s/it] 30%|███       | 3/10 [00:02<00:06,  1.05it/s] 40%|████      | 4/10 [00:03<00:05,  1.11it/s] 50%|█████     | 5/10 [00:04<00:04,  1.14it/s] 60%|██████    | 6/10 [00:05<00:03,  1.16it/s] 70%|███████   | 7/10 [00:06<00:02,  1.15it/s] 80%|████████  | 8/10 [00:07<00:01,  1.14it/s] 90%|█████████ | 9/10 [00:08<00:00,  1.16it/s]100%|██████████| 10/10 [00:08<00:00,  1.17it/s]100%|██████████| 10/10 [00:09<00:00,  1.10it/s]
Found cached dataset ag_news (/mnt/xfs/home/branhung/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548)
  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 426.01it/s]
Using pad_token, but it is not set yet.
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:11,  1.25s/it] 20%|██        | 2/10 [00:02<00:08,  1.03s/it] 30%|███       | 3/10 [00:02<00:06,  1.05it/s] 40%|████      | 4/10 [00:03<00:05,  1.10it/s] 50%|█████     | 5/10 [00:04<00:04,  1.13it/s] 60%|██████    | 6/10 [00:05<00:03,  1.16it/s] 70%|███████   | 7/10 [00:06<00:02,  1.17it/s] 80%|████████  | 8/10 [00:07<00:01,  1.16it/s] 90%|█████████ | 9/10 [00:08<00:00,  1.17it/s]100%|██████████| 10/10 [00:08<00:00,  1.18it/s]100%|██████████| 10/10 [00:09<00:00,  1.11it/s]
Downloading builder script:   0%|          | 0.00/5.22k [00:00<?, ?B/s]Downloading builder script: 100%|██████████| 5.22k/5.22k [00:00<00:00, 7.47MB/s]
Downloading metadata:   0%|          | 0.00/2.47k [00:00<?, ?B/s]Downloading metadata: 100%|██████████| 2.47k/2.47k [00:00<00:00, 5.40MB/s]
Downloading readme:   0%|          | 0.00/7.15k [00:00<?, ?B/s]Downloading readme: 100%|██████████| 7.15k/7.15k [00:00<00:00, 14.6MB/s]
Downloading data:   0%|          | 0.00/68.3M [00:00<?, ?B/s]Downloading data:   3%|▎         | 2.17M/68.3M [00:00<00:03, 21.7MB/s]Downloading data:  17%|█▋        | 11.6M/68.3M [00:00<00:00, 64.6MB/s]Downloading data:  32%|███▏      | 21.8M/68.3M [00:00<00:00, 81.6MB/s]Downloading data:  45%|████▌     | 31.0M/68.3M [00:00<00:00, 85.8MB/s]Downloading data:  58%|█████▊    | 39.6M/68.3M [00:00<00:00, 80.3MB/s]Downloading data:  70%|██████▉   | 47.7M/68.3M [00:00<00:00, 60.7MB/s]Downloading data:  84%|████████▎ | 57.2M/68.3M [00:00<00:00, 69.5MB/s]Downloading data:  95%|█████████▍| 64.8M/68.3M [00:00<00:00, 69.0MB/s]Downloading data: 100%|██████████| 68.3M/68.3M [00:00<00:00, 70.1MB/s]
Generating train split:   0%|          | 0/560000 [00:00<?, ? examples/s]Generating train split:   0%|          | 1826/560000 [00:00<00:31, 17581.66 examples/s]Generating train split:   1%|          | 5210/560000 [00:00<00:20, 26991.45 examples/s]Generating train split:   2%|▏         | 8578/560000 [00:00<00:18, 30013.42 examples/s]Generating train split:   2%|▏         | 12000/560000 [00:00<00:17, 31517.34 examples/s]Generating train split:   3%|▎         | 15444/560000 [00:00<00:16, 32545.14 examples/s]Generating train split:   3%|▎         | 18879/560000 [00:00<00:16, 33141.78 examples/s]Generating train split:   4%|▍         | 22271/560000 [00:00<00:16, 33394.30 examples/s]Generating train split:   5%|▍         | 25700/560000 [00:00<00:15, 33569.03 examples/s]Generating train split:   5%|▌         | 29061/560000 [00:00<00:15, 33580.98 examples/s]Generating train split:   6%|▌         | 32500/560000 [00:01<00:15, 33828.26 examples/s]Generating train split:   6%|▋         | 35966/560000 [00:01<00:15, 34078.74 examples/s]Generating train split:   7%|▋         | 41000/560000 [00:01<00:15, 33741.63 examples/s]Generating train split:   8%|▊         | 45254/560000 [00:01<00:21, 24436.59 examples/s]Generating train split:   9%|▊         | 48755/560000 [00:01<00:19, 26534.60 examples/s]Generating train split:   9%|▉         | 52107/560000 [00:01<00:18, 28131.28 examples/s]Generating train split:  10%|▉         | 55536/560000 [00:01<00:17, 29645.01 examples/s]Generating train split:  11%|█         | 58903/560000 [00:01<00:16, 30690.53 examples/s]Generating train split:  11%|█         | 62256/560000 [00:02<00:15, 31456.68 examples/s]Generating train split:  12%|█▏        | 65760/560000 [00:02<00:15, 32274.47 examples/s]Generating train split:  12%|█▏        | 69118/560000 [00:02<00:15, 32641.04 examples/s]Generating train split:  13%|█▎        | 72555/560000 [00:02<00:14, 33138.23 examples/s]Generating train split:  14%|█▍        | 77591/560000 [00:02<00:14, 33300.89 examples/s]Generating train split:  14%|█▍        | 81000/560000 [00:02<00:14, 33400.98 examples/s]Generating train split:  15%|█▌        | 84457/560000 [00:02<00:14, 33720.69 examples/s]Generating train split:  16%|█▌        | 87917/560000 [00:02<00:13, 33964.95 examples/s]Generating train split:  17%|█▋        | 92983/560000 [00:02<00:13, 33891.15 examples/s]Generating train split:  18%|█▊        | 98078/560000 [00:03<00:13, 33904.12 examples/s]Generating train split:  18%|█▊        | 101522/560000 [00:03<00:13, 34037.52 examples/s]Generating train split:  19%|█▊        | 104991/560000 [00:03<00:13, 34206.75 examples/s]Generating train split:  20%|█▉        | 110041/560000 [00:03<00:13, 34007.49 examples/s]Generating train split:  20%|██        | 113503/560000 [00:03<00:13, 34161.78 examples/s]Generating train split:  21%|██        | 116982/560000 [00:03<00:12, 34327.12 examples/s]Generating train split:  22%|██▏       | 122104/560000 [00:03<00:12, 34256.34 examples/s]Generating train split:  22%|██▏       | 125645/560000 [00:03<00:12, 34548.16 examples/s]Generating train split:  23%|██▎       | 130891/560000 [00:04<00:12, 34696.91 examples/s]Generating train split:  24%|██▍       | 136033/560000 [00:04<00:12, 34540.65 examples/s]Generating train split:  25%|██▍       | 139553/560000 [00:04<00:12, 34697.44 examples/s]Generating train split:  26%|██▌       | 144707/560000 [00:04<00:12, 34580.45 examples/s]Generating train split:  27%|██▋       | 149905/560000 [00:04<00:11, 34600.76 examples/s]Generating train split:  28%|██▊       | 155019/560000 [00:04<00:11, 34435.95 examples/s]Generating train split:  28%|██▊       | 158558/560000 [00:04<00:11, 34657.42 examples/s]Generating train split:  29%|██▉       | 163770/560000 [00:04<00:11, 34622.85 examples/s]Generating train split:  30%|███       | 168830/560000 [00:05<00:11, 34191.53 examples/s]Generating train split:  31%|███       | 173940/560000 [00:05<00:11, 34149.72 examples/s]Generating train split:  32%|███▏      | 179000/560000 [00:05<00:11, 34011.28 examples/s]Generating train split:  33%|███▎      | 184088/560000 [00:05<00:11, 33976.86 examples/s]Generating train split:  34%|███▍      | 189115/560000 [00:05<00:10, 33832.00 examples/s]Generating train split:  34%|███▍      | 192528/560000 [00:05<00:10, 33897.11 examples/s]Generating train split:  35%|███▍      | 195975/560000 [00:05<00:10, 34033.69 examples/s]Generating train split:  36%|███▌      | 201023/560000 [00:06<00:10, 33899.59 examples/s]Generating train split:  37%|███▋      | 204432/560000 [00:06<00:10, 33944.46 examples/s]Generating train split:  37%|███▋      | 207905/560000 [00:06<00:10, 34146.37 examples/s]Generating train split:  38%|███▊      | 213000/560000 [00:06<00:10, 34027.69 examples/s]Generating train split:  39%|███▊      | 216454/560000 [00:06<00:10, 34155.60 examples/s]Generating train split:  40%|███▉      | 221472/560000 [00:06<00:09, 33897.80 examples/s]Generating train split:  40%|████      | 224910/560000 [00:06<00:09, 34016.62 examples/s]Generating train split:  41%|████      | 230000/560000 [00:06<00:09, 33870.73 examples/s]Generating train split:  42%|████▏     | 233462/560000 [00:07<00:09, 34056.41 examples/s]Generating train split:  43%|████▎     | 238535/560000 [00:07<00:09, 33972.94 examples/s]Generating train split:  43%|████▎     | 241962/560000 [00:07<00:09, 34044.34 examples/s]Generating train split:  44%|████▍     | 246974/560000 [00:07<00:09, 33821.17 examples/s]Generating train split:  45%|████▌     | 252017/560000 [00:07<00:09, 33751.30 examples/s]Generating train split:  46%|████▌     | 257000/560000 [00:07<00:09, 33571.63 examples/s]Generating train split:  46%|████▋     | 260370/560000 [00:07<00:08, 33598.67 examples/s]Generating train split:  47%|████▋     | 263789/560000 [00:07<00:08, 33734.81 examples/s]Generating train split:  48%|████▊     | 268831/560000 [00:08<00:08, 33680.74 examples/s]Generating train split:  49%|████▉     | 273764/560000 [00:08<00:08, 33412.52 examples/s]Generating train split:  50%|████▉     | 278851/560000 [00:08<00:08, 33572.73 examples/s]Generating train split:  50%|█████     | 282294/560000 [00:08<00:08, 33772.52 examples/s]Generating train split:  51%|█████     | 285877/560000 [00:08<00:07, 34288.10 examples/s]Generating train split:  52%|█████▏    | 291064/560000 [00:08<00:07, 34385.86 examples/s]Generating train split:  53%|█████▎    | 294679/560000 [00:08<00:07, 34824.23 examples/s]Generating train split:  54%|█████▎    | 299968/560000 [00:08<00:07, 34973.39 examples/s]Generating train split:  54%|█████▍    | 303487/560000 [00:09<00:07, 35026.84 examples/s]Generating train split:  55%|█████▍    | 307000/560000 [00:09<00:07, 35025.37 examples/s]Generating train split:  56%|█████▌    | 312297/560000 [00:09<00:07, 35116.51 examples/s]Generating train split:  56%|█████▋    | 315914/560000 [00:09<00:06, 35384.46 examples/s]Generating train split:  57%|█████▋    | 321192/560000 [00:09<00:06, 35312.32 examples/s]Generating train split:  58%|█████▊    | 324854/560000 [00:09<00:06, 35497.90 examples/s]Generating train split:  59%|█████▉    | 329000/560000 [00:09<00:08, 27261.66 examples/s]Generating train split:  59%|█████▉    | 332584/560000 [00:10<00:07, 29121.91 examples/s]Generating train split:  60%|██████    | 336097/560000 [00:10<00:07, 30541.84 examples/s]Generating train split:  61%|██████    | 339607/560000 [00:10<00:06, 31678.33 examples/s]Generating train split:  61%|██████▏   | 343164/560000 [00:10<00:06, 32707.32 examples/s]Generating train split:  62%|██████▏   | 346853/560000 [00:10<00:06, 33668.33 examples/s]Generating train split:  63%|██████▎   | 350381/560000 [00:10<00:06, 34107.82 examples/s]Generating train split:  63%|██████▎   | 353962/560000 [00:10<00:05, 34590.74 examples/s]Generating train split:  64%|██████▍   | 357493/560000 [00:10<00:05, 34797.50 examples/s]Generating train split:  64%|██████▍   | 361058/560000 [00:10<00:05, 35044.15 examples/s]Generating train split:  65%|██████▌   | 364727/560000 [00:10<00:05, 35526.68 examples/s]Generating train split:  66%|██████▌   | 368385/560000 [00:11<00:05, 35835.43 examples/s]Generating train split:  67%|██████▋   | 373750/560000 [00:11<00:05, 35807.65 examples/s]Generating train split:  67%|██████▋   | 377359/560000 [00:11<00:05, 35882.55 examples/s]Generating train split:  68%|██████▊   | 381019/560000 [00:11<00:04, 36080.28 examples/s]Generating train split:  69%|██████▊   | 384736/560000 [00:11<00:04, 36386.59 examples/s]Generating train split:  69%|██████▉   | 388423/560000 [00:11<00:04, 36523.68 examples/s]Generating train split:  70%|███████   | 392114/560000 [00:11<00:04, 36633.96 examples/s]Generating train split:  71%|███████   | 395906/560000 [00:11<00:04, 36877.99 examples/s]Generating train split:  72%|███████▏  | 401247/560000 [00:11<00:04, 36384.86 examples/s]Generating train split:  73%|███████▎  | 406645/560000 [00:12<00:04, 36240.56 examples/s]Generating train split:  74%|███████▎  | 412000/560000 [00:12<00:04, 36045.07 examples/s]Generating train split:  75%|███████▍  | 417388/560000 [00:12<00:03, 36001.25 examples/s]Generating train split:  75%|███████▌  | 422616/560000 [00:12<00:03, 35636.23 examples/s]Generating train split:  76%|███████▌  | 426188/560000 [00:12<00:03, 35652.60 examples/s]Generating train split:  77%|███████▋  | 429863/560000 [00:12<00:03, 35851.37 examples/s]Generating train split:  78%|███████▊  | 435231/560000 [00:12<00:03, 35825.02 examples/s]Generating train split:  78%|███████▊  | 438895/560000 [00:12<00:03, 36025.89 examples/s]Generating train split:  79%|███████▉  | 444171/560000 [00:13<00:03, 35727.72 examples/s]Generating train split:  80%|████████  | 449420/560000 [00:13<00:03, 35482.65 examples/s]Generating train split:  81%|████████  | 453000/560000 [00:13<00:03, 35429.89 examples/s]Generating train split:  82%|████████▏ | 456566/560000 [00:13<00:02, 35486.00 examples/s]Generating train split:  82%|████████▏ | 461901/560000 [00:13<00:02, 35511.21 examples/s]Generating train split:  83%|████████▎ | 467087/560000 [00:13<00:02, 35191.97 examples/s]Generating train split:  84%|████████▍ | 470677/560000 [00:13<00:02, 35347.14 examples/s]Generating train split:  85%|████████▌ | 476000/560000 [00:14<00:02, 35298.56 examples/s]Generating train split:  86%|████████▌ | 479565/560000 [00:14<00:02, 35382.61 examples/s]Generating train split:  87%|████████▋ | 484775/560000 [00:14<00:02, 35158.70 examples/s]Generating train split:  88%|████████▊ | 490000/560000 [00:14<00:01, 35024.73 examples/s]Generating train split:  88%|████████▊ | 494366/560000 [00:14<00:01, 33128.00 examples/s]Generating train split:  89%|████████▉ | 497924/560000 [00:14<00:01, 33698.28 examples/s]Generating train split:  90%|████████▉ | 501417/560000 [00:14<00:01, 34005.78 examples/s]Generating train split:  90%|█████████ | 506549/560000 [00:14<00:01, 34051.59 examples/s]Generating train split:  91%|█████████ | 510037/560000 [00:15<00:01, 34255.37 examples/s]Generating train split:  92%|█████████▏| 515080/560000 [00:15<00:01, 34026.89 examples/s]Generating train split:  93%|█████████▎| 520000/560000 [00:15<00:01, 33489.65 examples/s]Generating train split:  93%|█████████▎| 523499/560000 [00:15<00:01, 33846.78 examples/s]Generating train split:  94%|█████████▍| 526977/560000 [00:15<00:00, 34083.75 examples/s]Generating train split:  95%|█████████▍| 531946/560000 [00:15<00:00, 33744.53 examples/s]Generating train split:  96%|█████████▌| 535346/560000 [00:15<00:00, 33806.81 examples/s]Generating train split:  96%|█████████▋| 540372/560000 [00:15<00:00, 33696.56 examples/s]Generating train split:  97%|█████████▋| 543838/560000 [00:16<00:00, 33936.47 examples/s]Generating train split:  98%|█████████▊| 548781/560000 [00:16<00:00, 33549.56 examples/s]Generating train split:  99%|█████████▉| 553724/560000 [00:16<00:00, 33349.42 examples/s]Generating train split:  99%|█████████▉| 557137/560000 [00:16<00:00, 33535.83 examples/s]                                                                                         Generating test split:   0%|          | 0/70000 [00:00<?, ? examples/s]Generating test split:   0%|          | 1/70000 [00:00<15:47:31,  1.23 examples/s]Generating test split:   4%|▍         | 3137/70000 [00:00<00:14, 4691.91 examples/s]Generating test split:   9%|▉         | 6564/70000 [00:01<00:06, 9899.30 examples/s]Generating test split:  14%|█▍        | 9845/70000 [00:01<00:04, 14502.84 examples/s]Generating test split:  19%|█▉        | 13247/70000 [00:01<00:03, 18855.20 examples/s]Generating test split:  24%|██▍       | 16796/70000 [00:01<00:02, 22797.73 examples/s]Generating test split:  29%|██▊       | 20042/70000 [00:01<00:01, 25270.22 examples/s]Generating test split:  34%|███▎      | 23501/70000 [00:01<00:01, 27765.43 examples/s]Generating test split:  39%|███▊      | 26958/70000 [00:01<00:01, 29647.20 examples/s]Generating test split:  46%|████▌     | 31899/70000 [00:01<00:01, 30870.11 examples/s]Generating test split:  53%|█████▎    | 36792/70000 [00:01<00:01, 31473.72 examples/s]Generating test split:  58%|█████▊    | 40301/70000 [00:02<00:00, 32370.23 examples/s]Generating test split:  63%|██████▎   | 43942/70000 [00:02<00:00, 33420.08 examples/s]Generating test split:  68%|██████▊   | 47552/70000 [00:02<00:00, 34139.53 examples/s]Generating test split:  76%|███████▌  | 52873/70000 [00:02<00:00, 26866.14 examples/s]Generating test split:  81%|████████  | 56443/70000 [00:02<00:00, 28755.27 examples/s]Generating test split:  85%|████████▌ | 59710/70000 [00:02<00:00, 29562.16 examples/s]Generating test split:  90%|█████████ | 63178/70000 [00:02<00:00, 30838.61 examples/s]Generating test split:  95%|█████████▌| 66692/70000 [00:02<00:00, 31968.08 examples/s]                                                                                        0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.59it/s]100%|██████████| 2/2 [00:00<00:00,  4.55it/s]
Using pad_token, but it is not set yet.
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:11,  1.27s/it] 20%|██        | 2/10 [00:02<00:08,  1.04s/it] 30%|███       | 3/10 [00:02<00:06,  1.06it/s] 40%|████      | 4/10 [00:03<00:05,  1.11it/s] 50%|█████     | 5/10 [00:04<00:04,  1.14it/s] 60%|██████    | 6/10 [00:05<00:03,  1.16it/s] 70%|███████   | 7/10 [00:06<00:02,  1.15it/s] 80%|████████  | 8/10 [00:07<00:01,  1.14it/s] 90%|█████████ | 9/10 [00:08<00:00,  1.16it/s]100%|██████████| 10/10 [00:08<00:00,  1.17it/s]100%|██████████| 10/10 [00:09<00:00,  1.10it/s]
Traceback (most recent call last):
  File "/mnt/xfs/home/branhung/src/robust-clip/uncertainty/sbatches/../main.py", line 34, in <module>
    _generate.main(generation_args)
  File "/mnt/xfs/home/branhung/src/robust-clip/uncertainty/_generate.py", line 13, in main
    dataloader = get_contrast_dataloader(args.dataset_name, args.split, tokenizer, args.prompt_idx, use_custom_prompt=args.use_custom_prompt,
  File "/mnt/xfs/home/branhung/src/robust-clip/uncertainty/data/contrast.py", line 199, in get_contrast_dataloader
    raw_dataset = load_dataset(dataset_name)[split]
  File "/mnt/xfs/home/branhung/conda_envs/llm/lib/python3.9/site-packages/datasets/load.py", line 1773, in load_dataset
    builder_instance = load_dataset_builder(
  File "/mnt/xfs/home/branhung/conda_envs/llm/lib/python3.9/site-packages/datasets/load.py", line 1502, in load_dataset_builder
    dataset_module = dataset_module_factory(
  File "/mnt/xfs/home/branhung/conda_envs/llm/lib/python3.9/site-packages/datasets/load.py", line 1215, in dataset_module_factory
    raise FileNotFoundError(
FileNotFoundError: Couldn't find a dataset script at /mnt/xfs/home/branhung/src/robust-clip/uncertainty/sbatches/copa/copa.py or any data file in the same directory. Couldn't find 'copa' on the Hugging Face Hub either: FileNotFoundError: Dataset 'copa' doesn't exist on the Hub. If the repo is private or gated, make sure to log in with `huggingface-cli login`.
